# Marten Desktop Pet with Environmental Intelligence

## Overview
Your desktop pet (Marten) now integrates with an MCP (Model Context Protocol) server to display real-time sustainability tips and environmental news!

## How It Works

1. **MCP Server** (`marten/marten.py`)
   - Fetches air quality data from OpenWeatherMap API
   - Gets environmental news from NewsAPI
   - Rates news sentiment using Gemini AI (0-10 scale)
   - Provides tools for the client to access this data

2. **Background Integration** (`marten_integration.py`)
   - Runs in a background thread alongside your desktop pet
   - Connects to the MCP server
   - Every 60 seconds:
     - Fetches latest environmental news
     - Gets local air quality data
     - Rates the news sentiment
     - Uses Gemini AI to generate actionable sustainability tips
   - Queues messages for the pet to display

3. **Desktop Pet** (`main.py`)
   - Your animated pet walks around the screen
   - Every 5 seconds, checks for new tips from Marten
   - Displays tips in speech bubbles with emojis:
     - Good news (rating 7-10)
     - Neutral news (rating 5-6)
     - Bad news (rating 0-4)
   - Click the pet for random friendly messages
   - Drag and drop the pet around the screen

## Features

### Pet Interactions
- **Click**: Show a random friendly message
- **Drag**: Move the pet around (falls back to taskbar)
- **Auto-tips**: Receives sustainability tips every 60 seconds

### Sustainability Tips
- Based on real environmental news
- Rated by sentiment (0-10 scale)
- Generated by Gemini AI
- Actionable advice for individuals
- Displayed in colored speech bubbles

### Data Sources
- Air Quality: OpenWeatherMap API
- Environmental News: NewsAPI
- AI Analysis: Google Gemini Pro

## Installation

```powershell
# Install dependencies
pip install -r marten/requirements.txt

# Run the desktop pet
python main.py
```

## Configuration

### API Keys (in `marten_integration.py`)
- Gemini API: Already configured
- OpenWeather API: Set in `marten.py`
- News API: Set in `marten.py`

### Timing (in `main.py`)
- `chat_display_duration`: How long tips stay visible (default: 10 seconds)
- Check interval: Every 5 seconds for new messages

### Location (in `backend/fetcher.py`)
- Default: Troy, NY (42.728, -73.687)
- Change `loc` dict to your coordinates

## Example Tips

Based on real news, Marten might say:
- "Switch to LED bulbs to save energy!"
- "Check your local recycling guidelines"
- "Reduce car trips this week for cleaner air"

## Architecture

```
Desktop Pet (main.py)
    ↓
Marten Integration (background thread)
    ↓
MCP Client → MCP Server (marten.py)
    ↓
Tools: check_air_quality, get_news, rate_sentiment
    ↓
APIs: OpenWeather, NewsAPI
    ↓
Gemini AI: Generate tips & rate sentiment
```
